# 🔑 Guardian 激活码使用说明

**版本**: v1.0.0  
**更新**: 2025-10-31

---

## 📋 激活码系统说明

从 v1.0.0 开始，Guardian 需要激活码才能使用。这是为了：
- ✅ 控制使用范围（教育机构、企业等）
- ✅ 防止滥用
- ✅ 提供更好的技术支持
- ✅ 追踪激活设备

---

## 🎯 演示激活码（免费使用）

以下激活码已内置在插件中，可直接使用：

### 1. 演示版（永久有效）
```
GUARD-DEMO-2025-TEST-0001
```
**用途**：功能演示、测试

### 2. 教育版（永久有效）
```
GUARD-EDU-2025-PERM-0001
```
**用途**：教育机构使用

### 3. 试用版（30天）
```
GUARD-TRIAL-30DAYS-0001
```
**用途**：30天试用

---

## 🚀 如何激活

### 方式1：首次安装时激活

1. 安装Guardian插件
2. 访问任意网站
3. 自动跳转到激活页面
4. 输入激活码（如：`GUARD-DEMO-2025-TEST-0001`）
5. 点击「激活」
6. 激活成功！

### 方式2：手动访问激活页面

```
chrome-extension://你的插件ID/activation/activation.html
```

### 方式3：通过控制台激活

在Service Worker控制台运行：

```javascript
chrome.runtime.sendMessage({
  action: 'activateLicense',
  data: {
    licenseKey: 'GUARD-DEMO-2025-TEST-0001',
    username: '您的姓名'
  }
}, (response) => {
  console.log(response.message);
});
```

---

## 🔧 激活码格式

**标准格式**：
```
GUARD-XXXX-XXXX-XXXX-XXXX
```

**说明**：
- `GUARD` - 固定前缀
- 第1部分 - 类型标识（DEMO/EDU/STD/TRIAL）
- 第2-3部分 - 随机字符
- 第4部分 - 校验码

**示例**：
```
GUARD-EDU-A1B2-C3D4-5678
```

---

## 🛠️ 生成激活码

### 使用生成器工具

打开 `激活码生成器.html` 文件：

```bash
open /home/sharelgx/MetaSeekOJdev/guardian-browser-extension/激活码生成器.html
```

或在浏览器中直接打开该文件。

### 通过代码生成

在Service Worker控制台运行：

```javascript
// 生成标准版激活码
function generateKey(type = 'standard') {
  const prefix = 'GUARD';
  const part1 = type === 'trial' ? 'TRIAL' : type === 'education' ? 'EDU' : 'STD';
  const part2 = Math.random().toString(36).substr(2, 4).toUpperCase().padEnd(4, '0');
  const part3 = Math.random().toString(36).substr(2, 4).toUpperCase().padEnd(4, '0');
  
  const checksum = (part1 + part2 + part3).split('').reduce((sum, char) => {
    return sum + char.charCodeAt(0);
  }, 0);
  const part4 = (checksum % 10000).toString().padStart(4, '0');
  
  return `${prefix}-${part1}-${part2}-${part3}-${part4}`;
}

// 生成10个激活码
for (let i = 0; i < 10; i++) {
  console.log(generateKey('education'));
}
```

---

## 📊 激活码管理

### 查看激活状态

```javascript
chrome.runtime.sendMessage({
  action: 'checkActivation'
}, (response) => {
  console.log('激活状态:', response.activated);
  console.log('激活信息:', response.activation);
});
```

### 停用激活码（需要管理员密码）

```javascript
chrome.runtime.sendMessage({
  action: 'deactivateLicense',
  data: { password: '您的管理员密码' }
}, (response) => {
  console.log(response.message);
});
```

---

## 🔗 与MetaSeekOJ集成

### 自动激活

在课堂系统中，可以自动为学生激活：

```javascript
// 学生加入课堂时自动激活
chrome.runtime.sendMessage('插件ID', {
  action: 'activateLicense',
  data: {
    licenseKey: '从服务器获取的激活码',
    username: student.real_name
  }
});
```

### 批量激活

```javascript
// 为整个班级批量激活
const students = [
  { id: 'S001', name: '张三', key: 'GUARD-EDU-...' },
  { id: 'S002', name: '李四', key: 'GUARD-EDU-...' },
  // ...
];

students.forEach(async (student) => {
  await chrome.runtime.sendMessage('插件ID', {
    action: 'activateLicense',
    data: {
      licenseKey: student.key,
      username: student.name
    }
  });
});
```

---

## ⚠️ 注意事项

### 1. 激活码唯一性
- 每个激活码对应一个设备
- 同一激活码不能在多个设备使用（可配置）

### 2. 过期处理
- 试用版激活码有效期30天
- 到期后需要重新激活
- 标准版和教育版永久有效

### 3. 安全建议
- 不要公开分享激活码
- 定期更换激活码
- 记录激活码使用情况

---

## 🎓 教育机构使用

### 为学校批量生成激活码

1. 打开激活码生成器
2. 选择「教育版」
3. 输入数量（如：100）
4. 生成
5. 导出CSV文件
6. 分发给学生

### 激活码管理系统（可选）

可以开发一个简单的管理系统：
- 生成和分配激活码
- 追踪激活状态
- 统计使用情况
- 管理过期和续期

---

## 📞 常见问题

### Q: 忘记激活码怎么办？

**A**: 在Service Worker控制台查看：
```javascript
chrome.storage.local.get('guardian_config', (data) => {
  console.log('激活码:', data.guardian_config.activation.licenseKey);
});
```

### Q: 激活码可以共享吗？

**A**: 不建议。每个激活码对应一个设备ID，共享可能导致冲突。

### Q: 如何延长试用期？

**A**: 使用新的试用版激活码，或升级到标准版/教育版。

---

**生成激活码工具**: `激活码生成器.html`  
**内置演示码**: 见上文

---

**祝您使用愉快！** 🎊

